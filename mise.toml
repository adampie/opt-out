[tools]
shellcheck = "latest"
shfmt = "latest"
taplo = "latest"
markdownlint-cli2 = "latest"
pkl = "latest"

[tasks.flake-check]
description = "Validate the flake and all tool definitions"
run = "nix flake check"

[tasks.fmt]
description = "Format all Nix files"
run = "nix-shell -p nixfmt-rfc-style --run 'nixfmt .'"

[tasks.lint]
description = "Lint all Nix files with statix and deadnix"
run = "nix-shell -p statix deadnix --run 'statix check . && deadnix .'"

[tasks.lint-md]
description = "Lint all Markdown files"
run = "markdownlint-cli2 **/*.md"

[tasks.lint-sh]
description = "Lint all shell scripts"
run = "shellcheck scripts/*.sh && shfmt -d scripts/*.sh"

[tasks.lint-toml]
description = "Lint all TOML files"
run = "taplo check"

[tasks.lint-yaml]
description = "Lint all YAML files"
run = "nix-shell -p yamllint --run 'yamllint .'"

[tasks.lint-pkl]
description = "Lint all Pkl files"
run = "hk validate"

[tasks.lint-all]
description = "Run all linters"
depends = ["flake-check", "lint", "lint-md", "lint-sh", "lint-toml", "lint-yaml", "lint-pkl"]

[tasks.flake-update]
description = "Update all flake inputs"
run = "nix flake update"

[tasks.readme-vars]
description = "Regenerate the environment variables section in README.md"
run = "bash scripts/readme-vars.sh"
